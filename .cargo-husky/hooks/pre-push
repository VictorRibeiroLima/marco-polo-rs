#!/bin/sh
#
# This hook was set by cargo-husky v1.0.0: https://github.com/rhysd/cargo-husky#readme
# Generated by script /path/to/cargo-husky/build.rs
# Output at /path/to/target/debug/build/cargo-husky-xxxxxx/out
#

# Run SQLx prepare
cargo sqlx prepare --workspace

# Stage the generated file
git add .sqlx/*

# Check if there are changes to commit
if [ -n "$(git status --porcelain .sqlx/* )" ]; then
  # Commit the changes
  git commit -m "chore: Generated SQLx file"
  
 # Get the current branch name
  BRANCH_NAME=$(git symbolic-ref --short HEAD)

  # Push the changes
  git push origin "$BRANCH_NAME"
fi