#!/bin/sh
#
# This hook was set by cargo-husky v1.0.0: https://github.com/rhysd/cargo-husky#readme
# Generated by script /path/to/cargo-husky/build.rs
# Output at /path/to/target/debug/build/cargo-husky-xxxxxx/out
#

rm ./target/debug/deps/marco_polo_rs_core*
rm ./target/debug/deps/libmarco_polo_rs_core*

SQLX_OFFLINE=true cargo build --tests

if [ $? -eq 0 ]; then
  echo "Cargo build was successful. Running tests now..."

  cargo test
else
  echo "Cargo build failed. Please run 'cargo sqlx prepare --workspace -- --tests ' and try again."
  exit 1
fi